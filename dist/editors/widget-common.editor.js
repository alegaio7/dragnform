export default class WidgetCommonPropertiesEditor{constructor(e){if(!e)throw new Error("WidgetCommonPropertiesEditor options is required");if(!e.dialogContainer)throw new Error("WidgetCommonPropertiesEditor options.dialogContainer is required");if(!e.widget)throw new Error("WidgetCommonPropertiesEditor options.widget is required");var t;if(this.widget=e.widget,"string"==typeof e.dialogContainer)t=document.getElementById(e.dialogContainer);else{if(!(e.dialogContainer instanceof HTMLElement))throw new Error("WidgetCommonPropertiesEditor options.dialogContainer must be a string or HTMLElement");t=e.dialogContainer}var n=this;this._dialogContainer=t;var i=e.widget.getEditorProperties();i&&i.forEach((e=>{if(e.elementId){let t=document.getElementById(e.elementId);t&&(e.readonly?t.innerHTML=e.value:"boolean"===e.type?t.checked=e.value:"number"!==e.type&&"string"!==e.type||(t.value=e.value))}else e.elementIds&&e.elementIds.forEach((t=>{let n=document.getElementById(t);n&&(n.value===e.value?n.checked=!0:n.checked=!1)}))})),e.callbacks||(e.callbacks={}),this._callbacks=e.callbacks;var a=this._dialogContainer.querySelector('[data-action="accept"]');a&&(a.onclick=function(){var e=n._updateWidgetPropertiesFromControls();this._callbacks.onAccept&&n._callbacks.onAccept(n,e)}.bind(this));var o=this._dialogContainer.querySelector('[data-action="cancel"]');o&&(o.onclick=function(){i&&i.forEach((e=>{n.widget[e.name]=e.value})),this._callbacks.onCancel&&n._callbacks.onCancel(n)}.bind(this)),this.txtLabel=document.getElementById("txtWidgetPropLabel"),this.txtLabel&&this._callbacks.onLabelChanged&&(this.txtLabel.addEventListener("change",(function(){n._callbacks.onLabelChanged(n,n.widget,n.txtLabel.value)})),this.txtLabel.addEventListener("input",(function(){n._callbacks.onLabelChanged(n,n.widget,n.txtLabel.value)}))),this.txtFontSize=document.getElementById("txtWidgetFontSize"),this.txtFontSize&&this._callbacks.onFontSizeChanged&&this.txtFontSize.addEventListener("change",(function(){var e=parseInt(n.txtFontSize.value,10);n._callbacks.onFontSizeChanged(n,n.widget,e)})),this.optFontWeights=this._dialogContainer.querySelectorAll('input[name="fontWeight"]'),this.optFontWeights&&this._callbacks.onFontWeightChanged&&this.optFontWeights.forEach((function(e){e.addEventListener("change",(function(){n._callbacks.onFontWeightChanged(n,n.widget,this.value)}))})),this.chkFontUnderline=document.getElementById("chkWidgetPropFontUnderline"),this.chkFontUnderline&&this.chkFontUnderline.addEventListener("change",(function(){n._updateControls(),n._callbacks.onFontUnderlineChanged&&n._callbacks.onFontUnderlineChanged(n,n.widget,n.chkFontUnderline.checked)})),this.txtColumns=document.getElementById("txtWidgetPropColumns"),this.txtColumns&&this._callbacks.onColumnsChanged&&this.txtColumns.addEventListener("change",(function(){var e=parseInt(n.txtColumns.value,10);n._callbacks.onColumnsChanged(n,n.widget,e)})),this.chkAutoHeight=document.getElementById("chkWidgetPropAutoHeight"),this.chkAutoHeight&&this.chkAutoHeight.addEventListener("change",(function(){n._updateControls(),n._callbacks.onAutoHeightChanged&&n._callbacks.onAutoHeightChanged(n,n.widget,n.chkAutoHeight.checked)})),this.txtHeight=document.getElementById("txtWidgetPropHeight"),this.txtHeight&&this._callbacks.onHeightChanged&&this.txtHeight.addEventListener("change",(function(){if(!n.chkAutoHeight.checked){var e=parseInt(n.txtHeight.value,10);n._callbacks.onHeightChanged(n,n.widget,e)}})),this.chkRequired=document.getElementById("chkWidgetPropRequired"),this.chkRequired&&this._callbacks.onRequiredChanged&&this.chkRequired.addEventListener("change",(function(){n._callbacks.onRequiredChanged(n,n.widget,n.chkRequired.checked)})),this.optHAlignments=this._dialogContainer.querySelectorAll('input[name="halignment"]'),this.optHAlignments&&this._callbacks.onHorizontalAlignmentChanged&&this.optHAlignments.forEach((function(e){e.addEventListener("change",(function(){n._callbacks.onHorizontalAlignmentChanged(n,n.widget,this.value)}))})),this.optVAlignments=this._dialogContainer.querySelectorAll('input[name="valignment"]'),this.optVAlignments&&this._callbacks.onVerticalAlignmentChanged&&this.optVAlignments.forEach((function(e){e.addEventListener("change",(function(){n._callbacks.onVerticalAlignmentChanged(n,n.widget,this.value)}))})),this.txtTip=document.getElementById("txtWidgetPropTip"),this.txtTip&&this._callbacks.onTipChanged&&(this.txtTip.addEventListener("change",(function(){n._callbacks.onTipChanged(n,n.widget,n.txtTip.value)})),this.txtTip.addEventListener("input",(function(){n._callbacks.onTipChanged(n,n.widget,n.txtTip.value)})))}init(){var e=this._dialogContainer.querySelector("input,select");e&&(e.focus(),"function"==typeof e.select&&e.select())}_updateControls(){document.getElementById("txtWidgetPropHeight").disabled=this.chkAutoHeight.checked}_updateWidgetPropertiesFromControls(){var e=this.widget.getEditorProperties();this.widget.batchUpdating=!0;var t=[];return e&&e.forEach((e=>{if(e.elementId){if(e.readonly)return;if(e.name in this.widget){var n=document.getElementById(e.elementId);n&&("boolean"===e.type?this.widget[e.name]=n.checked:"number"===e.type?""===n.value||isNaN(n.value)?this.widget[e.name]=null:this.widget[e.name]=parseInt(n.value,10):this.widget[e.name]=n.value,t.push(e.name))}}else e.elementIds&&e.elementIds.forEach((n=>{var i=document.getElementById(n);i&&i.checked&&(this.widget[e.name]=i.value,t.push(e.name))}))})),this.widget.batchUpdating=!1,t}}