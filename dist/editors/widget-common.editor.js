export default class WidgetCommonPropertiesEditor{constructor(t){if(!t)throw new Error("WidgetCommonPropertiesEditor options is required");if(!t.dialogContainer)throw new Error("WidgetCommonPropertiesEditor options.dialogContainer is required");if(!t.widget)throw new Error("WidgetCommonPropertiesEditor options.widget is required");var e;if(this.widget=t.widget,"string"==typeof t.dialogContainer)e=document.getElementById(t.dialogContainer);else{if(!(t.dialogContainer instanceof HTMLElement))throw new Error("WidgetCommonPropertiesEditor options.dialogContainer must be a string or HTMLElement");e=t.dialogContainer}var n=this;this._dialogContainer=e,this._editorProps=t.widget.getEditorProperties(),this._editorProps&&this._editorProps.forEach((t=>{if(t.elementId){let e=document.getElementById(t.elementId);e&&(t.readonly?e.innerHTML=t.value:"boolean"===t.type?e.checked=t.value:"number"!==t.type&&"string"!==t.type||(e.value=t.value))}else t.elementIds&&"multiple"===t.type&&t.elementIds.forEach((e=>{let n=document.getElementById(e);n&&(n.value===t.value?n.checked=!0:n.checked=!1)}))})),t.callbacks||(t.callbacks={}),this._callbacks=t.callbacks;var i=this._dialogContainer.querySelector('[data-action="accept"]');i&&(i.onclick=function(){n._acceptDialogHandler()}.bind(this));var a=this._dialogContainer.querySelector('[data-action="cancel"]');a&&(a.onclick=function(){n._cancelDialogHandler()}.bind(this)),this.txtLabel=document.getElementById("txtWidgetPropLabel"),this.txtLabel&&this._callbacks.onLabelChanged&&(this.txtLabel.addEventListener("change",(function(){n._callbacks.onLabelChanged(n,n.widget,n.txtLabel.value)})),this.txtLabel.addEventListener("input",(function(){n._callbacks.onLabelChanged(n,n.widget,n.txtLabel.value)}))),this.txtFontSize=document.getElementById("txtWidgetFontSize"),this.txtFontSize&&this._callbacks.onFontSizeChanged&&this.txtFontSize.addEventListener("change",(function(){var t=parseInt(n.txtFontSize.value,10);n._callbacks.onFontSizeChanged(n,n.widget,t)})),this.optFontWeights=this._dialogContainer.querySelectorAll('input[name="fontWeight"]'),this.optFontWeights&&this._callbacks.onFontWeightChanged&&this.optFontWeights.forEach((function(t){t.addEventListener("change",(function(){n._callbacks.onFontWeightChanged(n,n.widget,this.value)}))})),this.chkFontUnderline=document.getElementById("chkWidgetPropFontUnderline"),this.chkFontUnderline&&this.chkFontUnderline.addEventListener("change",(function(){n._updateControls(),n._callbacks.onFontUnderlineChanged&&n._callbacks.onFontUnderlineChanged(n,n.widget,n.chkFontUnderline.checked)})),this.txtColumns=document.getElementById("txtWidgetPropColumns"),this.txtColumns&&this._callbacks.onColumnsChanged&&this.txtColumns.addEventListener("change",(function(){var t=parseInt(n.txtColumns.value,10);n._callbacks.onColumnsChanged(n,n.widget,t)})),this.chkAutoHeight=document.getElementById("chkWidgetPropAutoHeight"),this.chkAutoHeight&&this.chkAutoHeight.addEventListener("change",(function(){n._updateControls(),n._callbacks.onAutoHeightChanged&&n._callbacks.onAutoHeightChanged(n,n.widget,n.chkAutoHeight.checked)})),this.txtHeight=document.getElementById("txtWidgetPropHeight"),this.txtHeight&&this._callbacks.onHeightChanged&&this.txtHeight.addEventListener("change",(function(){if(!n.chkAutoHeight.checked){var t=parseInt(n.txtHeight.value,10);n._callbacks.onHeightChanged(n,n.widget,t)}})),this.chkRequired=document.getElementById("chkWidgetPropRequired"),this.chkRequired&&this._callbacks.onRequiredChanged&&this.chkRequired.addEventListener("change",(function(){n._callbacks.onRequiredChanged(n,n.widget,n.chkRequired.checked)})),this.optHAlignments=this._dialogContainer.querySelectorAll('input[name="halignment"]'),this.optHAlignments&&this._callbacks.onHorizontalAlignmentChanged&&this.optHAlignments.forEach((function(t){t.addEventListener("change",(function(){n._callbacks.onHorizontalAlignmentChanged(n,n.widget,this.value)}))})),this.optVAlignments=this._dialogContainer.querySelectorAll('input[name="valignment"]'),this.optVAlignments&&this._callbacks.onVerticalAlignmentChanged&&this.optVAlignments.forEach((function(t){t.addEventListener("change",(function(){n._callbacks.onVerticalAlignmentChanged(n,n.widget,this.value)}))})),this.txtTip=document.getElementById("txtWidgetPropTip"),this.txtTip&&this._callbacks.onTipChanged&&(this.txtTip.addEventListener("change",(function(){n._callbacks.onTipChanged(n,n.widget,n.txtTip.value)})),this.txtTip.addEventListener("input",(function(){n._callbacks.onTipChanged(n,n.widget,n.txtTip.value)})))}init(){var t=this._dialogContainer.querySelector("input,select");t&&(t.focus(),"function"==typeof t.select&&t.select()),this._updateControls()}_acceptDialogHandler(){var t=this._updateWidgetPropertiesFromControls();this._callbacks.onAccept&&this._callbacks.onAccept(this,t)}_cancelDialogHandler(){this._editorProps&&this._editorProps.forEach((t=>{this.widget[t.name]=t.value})),this._callbacks.onCancel&&this._callbacks.onCancel(this)}_updateControls(){document.getElementById("txtWidgetPropHeight").disabled=this.chkAutoHeight.checked}_updateWidgetPropertiesFromControls(){var t=this.widget.getEditorProperties();this.widget.batchUpdating=!0;var e=[];return t&&t.forEach((t=>{if(t.elementId){if(t.readonly)return;if(t.name in this.widget){var n=document.getElementById(t.elementId);n&&("boolean"===t.type?this.widget[t.name]=n.checked:"number"===t.type?""===n.value||isNaN(n.value)?this.widget[t.name]=null:this.widget[t.name]=parseInt(n.value,10):this.widget[t.name]=n.value,e.push(t.name))}}else t.elementIds&&"multiple"===t.type&&t.elementIds.forEach((n=>{var i=document.getElementById(n);i&&i.checked&&(this.widget[t.name]=i.value,e.push(t.name))}))})),this.widget.batchUpdating=!1,e}}