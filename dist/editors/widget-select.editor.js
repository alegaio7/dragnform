import WidgetCommonPropertiesEditor from"./widget-common.editor.js";export default class WidgetSelectPropertiesEditor extends WidgetCommonPropertiesEditor{constructor(t){super(t);t=t.widget.selectOptions??[];this._selectOptions=t,this._savedSelectOptions=[...t],this._setupSelectOptions(),this._dialogContainer.querySelector('[data-action="add"]').addEventListener("click",(t=>{var e=this._addSelectOption();if(this._callbacks.onSelectOptionAdd){var i=this._callbacks.onSelectOptionAdd(this,this.widget,{title:"",value:""});e.setAttribute("data-id",i.id)}}))}init(){super.init(),this._updateControls()}_addSelectOption(t,e){t||(t=this._selectOptions.length+1);var i=this._dialogContainer.querySelector('[data-part="select-options-container"]'),a=i.querySelector('.widget-select-option[data-index="1"]').cloneNode(!0);a.setAttribute("data-index",t),a.setAttribute("data-id",""),e&&a.setAttribute("data-id",e.id);let o=a.querySelector('[data-part="option-title"]');o.setAttribute("id",`txtSelectOptionTitle${t}`),o.value=e?e.title:"";let l=a.querySelector('[data-part="option-value"]');return l.setAttribute("id",`txtSelectOptionValue${t}`),l.value=e?e.value:"",a.querySelector('[data-action="remove"]').removeAttribute("style"),i.appendChild(a),this._attachHandlers(a),a}_attachHandlers(t){t.querySelector('[data-action="remove"]').addEventListener("click",(e=>{if(confirm(Strings.WidgetEditor_Select_Confirm_Remove_Option_Message)){t.remove();let e=t.getAttribute("data-id");this._callbacks.onSelectOptionRemove&&this._callbacks.onSelectOptionRemove(this,this.widget,e)}}));for(var e=["change","input"],i=0;i<e.length;i++)t.querySelector('[data-part="option-title"]').addEventListener(e[i],(e=>{if(this._callbacks.onSelectOptionTitleChanged){let i=t.getAttribute("data-id");this._callbacks.onSelectOptionTitleChanged(this,this.widget,e.target.value,i)}})),t.querySelector('[data-part="option-value"]').addEventListener(e[i],(e=>{if(this._callbacks.onSelectOptionValueChanged){let i=t.getAttribute("data-id");this._callbacks.onSelectOptionValueChanged(this,this.widget,e.target.value,i)}}))}_cancelDialogHandler(){super._cancelDialogHandler(),this.widget.selectOptions=this._savedSelectOptions}_setupSelectOptions(){for(var t=this._dialogContainer.querySelector('[data-part="select-options-container"]'),e=0;e<this._selectOptions.length;e++){var i=e+1;if(i<=2){var a=this._selectOptions[e];let o=t.querySelector(`.widget-select-option[data-index="${i}"]`);o.setAttribute("data-id",a.id),o.querySelector('[data-part="option-title"]').value=this._selectOptions[e].title,o.querySelector('[data-part="option-value"]').value=this._selectOptions[e].value,o.querySelector('[data-action="remove"]').setAttribute("style","display: none"),this._attachHandlers(o)}else this._addSelectOption(i,this._selectOptions[e])}}_updateControls(){super._updateControls()}}